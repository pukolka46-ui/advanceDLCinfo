let role = localStorage.getItem("role") || "guest";

document.querySelectorAll("[data-go]").forEach(b=>{
  b.onclick=()=>location.href=b.dataset.go;
});

const paywall=document.getElementById("paywall");

document.getElementById("openPaywall")?.onclick=()=>paywall.classList.remove("hidden");
document.querySelectorAll(".buy").forEach(b=>b.onclick=()=>paywall.classList.remove("hidden"));
document.getElementById("closePaywall")?.onclick=()=>paywall.classList.add("hidden");

document.getElementById("unlock")?.onclick=()=>{
  localStorage.setItem("role","premium");
  location.href="cabinet.html";
};

if(location.pathname.includes("cabinet")){
  if(role==="guest") location.href="/";
  document.getElementById("role").textContent=role;
  document.getElementById("status").textContent="Активен";
}

if(location.pathname.includes("admin") && role!=="admin"){
  location.href="/";
}

function setRole(r){
  localStorage.setItem("role",r);
  alert("Роль изменена: "+r);
}

document.getElementById("logout")?.onclick=()=>{
  localStorage.setItem("role","guest");
  location.href="/";
};
